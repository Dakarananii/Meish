extends layout/layout

block meta

  meta(property="og:type" content="website")
  meta(property="og:title" content="Meish*")
  meta(property="og:site_name" content="バーチャルプロフィール登録サービス")
  meta(property="og:url" content="http://www.meish.me/")
  meta(property="og:image" content="https://meish.s3-ap-northeast-1.amazonaws.com/meish_logo_ogp.jpg")
  meta(property="og:locale" content="ja_JP")
  meta(name="twitter:card" content="summary_large_image")

block content
  
  section#TopSection.page-section
    div.text-center
      div(style="height:100px;").logo.mb-4
      h6.m-3 バーチャルキャラクターのためのプロフィール登録サービス
      .tags.mt-5
        div.m-2
          - var topTag = tags.slice(0,15)
          each tag in topTag
            - var tagLink = "/search?query=" + tag.tagname
            - var tagHue = tag.tagname.charCodeAt(0) % 36 * 10;
            - var tagText = `${tag.tagname}: ${tag.dataValues.count}`
            a(href=tagLink)
              span(style="background-color:hsl("+tagHue+", 50%, 45%);").badge.badge-secondary.p-2.m-1 #{tagText}
          button(onclick="$('.tags').toggle();").badge.badge-secondary.p-2.m-1 
            span ...
      div(style="display:none;").tags
        div.m-2
          each tag in tags.slice(0,300)
            - var tagLink = "/search?query=" + tag.tagname
            - var tagHue = tag.tagname.charCodeAt(0) % 36 * 10;
            - var tagText = `${tag.tagname}: ${tag.dataValues.count}`
            a(href=tagLink)
              span(style="background-color:hsl("+tagHue+", 50%, 45%);").badge.badge-secondary.p-2.m-1 #{tagText}
          button(onclick="$('.tags').toggle();").badge.badge-secondary.p-2.m-1 
            span Close

    div.d-flex.flex-wrap.justify-content-around
      if results
        each result in results
          div.m-3
            - var link = `/i/${result.username}`
            a(href=link)
              div(style="background-color: rgba(255,255,255,0.5); width:200px; height:350px; overflow: hidden;").card
                - var style=`width: 100%; height: 100%; ${result.isSensitive ? "filter: blur(5px);" : ""} background-image: url(${s3+result.thumbnail_path}); background-size: contain; background-repeat: no-repeat; background-position: center;`
                div(style=style).card-img-top

    if results && results.length == 30
      div.d-flex.flex-wrap.justify-content-around
        a(href="/all")
          button.btn.btn-outline-info.m-3 全部見る（重いかも）

    if userCount
      div.text-center
        h6
          small.text-secondary Total #{userCount} characters.